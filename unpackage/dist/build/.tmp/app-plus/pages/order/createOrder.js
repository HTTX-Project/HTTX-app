(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/createOrder"],{"0438":function(t,e,o){"use strict";(function(t){o("29bd"),o("921b");a(o("66fd"));var e=a(o("e204"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])},"065d":function(t,e,o){},"2ecd":function(t,e,o){"use strict";var a,r=function(){var t=this,e=t.$createElement;t._self._c},s=[];o.d(e,"b",function(){return r}),o.d(e,"c",function(){return s}),o.d(e,"a",function(){return a})},"5b5d":function(t,e,o){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(o("2c1c")),s=n(o("dcec"));function n(t){return t&&t.__esModule?t:{default:t}}var i={data:function(){return{maskState:0,desc:"",payType:1,couponList:[{title:"新用户专享优惠券",price:5},{title:"庆五一发一波优惠券",price:10},{title:"优惠券优惠券优惠券优惠券",price:15}],items:[{value:"1",name:"在线支付"},{value:"2",name:"奖金积分支付",checked:"true"},{value:"3",name:"积分奖金混合支付"}],user:{},url:"",num:1,goodList:[],total:0,goodsTool:0,yhTotal:0,gwj:0,useGWJStu:!1,current:1,isAddress:!1,isCartStatus:!1,addressData:{ADDRESS:"",CITY:"",DISTRICT:"",IS_USE:"",NAME:"",PROVINCE:"",TEL:"",USER_ID:"",VIP_ID:""}}},onLoad:function(e){console.log(t(e.id," at pages/order/createOrder.vue:155")),a.showLoading({mask:!0}),this.user=this.$store.state.userInfo,this.url=this.$store.state.imgUrl,e.id?(this.isCartStatus=!1,this.num=e.num,this.getData(e.id),this.getAddress()):(console.log(t("getShopList"," at pages/order/createOrder.vue:167")),this.isCartStatus=!0,this.getShopList())},onShow:function(){console.log(t("addressData",this.addressData," at pages/order/createOrder.vue:173"))},methods:{getData:function(e){var o=this,s=this;r.default.get("/goodImpl/goodInfo?GOOD_ID=".concat(e,"&USER_ID=").concat(this.user.USER_ID),[]).then(function(e){o.goodList.push({goodsDetail:e.data.goodInfo,buyNumber:s.num,active:!0}),s.conutTotal(),s.getJD(),console.log(t("goodInfo",s.goodList," at pages/order/createOrder.vue:186"))}).catch(function(e){console.log(t("单商品报错",e," at pages/order/createOrder.vue:188"))}).finally(function(){a.hideLoading({})})},getShopList:function(){var e=this;a.getStorage({key:"shopCar",success:function(t){e.goodList=t.data,e.getAddress(),e.conutTotal(),e.getJD(),a.hideLoading({})},fail:function(e){console.log(t("订单购物车失败",e," at pages/order/createOrder.vue:204")),a.hideLoading({})}})},getAddress:function(){var e=this;a.showLoading({mask:!0}),r.default.get("/userImpl/getAddressList?USER_ID=".concat(this.user.USER_ID),[]).then(function(t){t.data.addList.length?(e.addressData=t.data.addList[0],e.isAddress=!0):e.isAddress=!1}).catch(function(e){console.log(t("获取默认地址报错",e," at pages/order/createOrder.vue:222"))}).finally(function(){a.hideLoading({})})},changeGwj:function(t){this.useGWJStu=t.detail.value,t.detail.value?this.gwj>0&&(this.total=this.goodsTool-this.gwj,this.yhTotal=this.gwj):(this.total=this.goodsTool,this.yhTotal=0)},getJD:function(){var e=this,o=[],s=!0,n=!1,i=void 0;try{for(var u,d=this.goodList[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var c=u.value;c.active&&o.push({goodId:c.goodsDetail.USER_ID,num:c.buyNumber,price:c.goodsDetail.PRICE})}}catch(f){n=!0,i=f}finally{try{s||null==d.return||d.return()}finally{if(n)throw i}}var l={userId:e.user.USER_ID,orderGoodList:o};r.default.post("/orderImpl/getCanUseGWJ",l).then(function(t){e.gwj=t.data.GWJ}).catch(function(e){console.log(t("单商品报错",e," at pages/order/createOrder.vue:258"))}).finally(function(){a.hideLoading({})})},conutTotal:function(){var t=0,e=!0,o=!1,a=void 0;try{for(var r,n=this.goodList[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var i=r.value;i.active&&(t=s.default.accMul(i.buyNumber,i.goodsDetail.PRICE))}}catch(u){o=!0,a=u}finally{try{e||null==n.return||n.return()}finally{if(o)throw a}}this.goodsTool=t,this.total=t},toggleMask:function(t){var e=this,o="show"===t?10:300,a="show"===t?1:0;this.maskState=2,setTimeout(function(){e.maskState=a},o)},radioChange:function(t){for(var e=0;e<this.items.length;e++)if(this.items[e].value===t.target.value){this.current=this.items[e].value;break}},numberChange:function(t){this.number=t.number},changePayType:function(t){this.payType=t},submit:function(){var e=this;if(!this.addressData.USER_ID&&""==this.addressData.USER_ID)return this.$api.msg("请选择收货地址"),!1;a.showLoading({mask:!0});var o=[],s=!0,n=!1,i=void 0;try{for(var u,d=this.goodList[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var c=u.value;o.push({goodId:c.goodsDetail.USER_ID,num:c.buyNumber,price:c.goodsDetail.PRICE})}}catch(f){n=!0,i=f}finally{try{s||null==d.return||d.return()}finally{if(n)throw i}}var l={userId:this.user.USER_ID,addressId:this.addressData.USER_ID,payType:this.current,orderGoodList:o};this.useGWJStu?l.gwj=this.gwj:l.gwj=0,console.log(t("obj",l," at pages/order/createOrder.vue:325")),r.default.post("/orderImpl/beforePayCheck",l).then(function(t){var o=t.data;e.isCartStatus&&e.clearCart(),e.$mRouter.push({route:e.$mRouterConfig.pay,query:{orderCode:o.order_code,addressId:e.addressData.USER_ID,count:e.total,status:e.current}})}).catch(function(e){console.log(t("提交订单报错",e," at pages/order/createOrder.vue:341"))}).finally(function(){a.hideLoading({})})},clearCart:function(){a.removeStorage({key:"shopCar",success:function(t){}})},stopPrevent:function(){}}};e.default=i}).call(this,o("0de9")["default"],o("6e42")["default"])},"8f27":function(t,e,o){"use strict";var a=o("065d"),r=o.n(a);r.a},ca62:function(t,e,o){"use strict";o.r(e);var a=o("5b5d"),r=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);e["default"]=r.a},e204:function(t,e,o){"use strict";o.r(e);var a=o("2ecd"),r=o("ca62");for(var s in r)"default"!==s&&function(t){o.d(e,t,function(){return r[t]})}(s);o("8f27");var n,i=o("f0c5"),u=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],n);e["default"]=u.exports}},[["0438","common/runtime","common/vendor"]]]);